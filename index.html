<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paste and Print</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- html2canvas CDN for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- jsPDF CDN for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- DOMPurify CDN for HTML sanitization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.3.10/purify.min.js"></script>
    <style>
        /* Base Light Mode Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
            transition: background-color 0.3s ease; /* Smooth transition for theme change */
        }
        .container {
            background-color: #ffffff;
            border-radius: 12px; /* Rounded corners */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Soft shadow */
            padding: 1.5rem;
            width: 100%;
            max-width: 800px;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            position: relative;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        .editable-area {
            width: 100%;
            min-height: 400px;
            padding: 1rem;
            border: 2px solid #cbd5e0; /* Light gray border */
            border-radius: 8px; /* Slightly rounded corners */
            font-size: 1rem;
            outline: none;
            overflow-y: auto; /* Enable scrolling for content */
            transition: border-color 0.2s ease-in-out, background-color 0.3s ease, color 0.3s ease;
            line-height: 1.5; /* Improve readability */
            color: #333; /* Default text color */
        }
        .editable-area:focus {
            border-color: #3b82f6; /* Blue border on focus */
        }
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            padding: 0.75rem;
            background-color: #e2e8f0; /* Lighter gray for toolbar */
            border-radius: 8px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        .toolbar-button, .toolbar-select, .toolbar-color-picker, .action-button {
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            border: 1px solid #cbd5e0;
            background-color: #ffffff;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, border-color 0.2s ease-in-out, color 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            color: #4a5568;
        }
        .toolbar-button:hover, .toolbar-select:hover, .action-button:hover {
            background-color: #e2e8f0;
            border-color: #a0aec0;
        }
        .toolbar-button:active, .toolbar-select:active, .action-button:active {
            transform: translateY(0);
        }
        .toolbar-button.active {
            background-color: #3b82f6;
            color: #ffffff;
            border-color: #3b82f6;
        }
        .toolbar-color-picker {
            width: 40px; /* Adjust width for color picker */
            padding: 0;
            height: 36px; /* Match button height */
            cursor: pointer;
        }
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: flex-end; /* Align buttons to the right */
        }
        .action-buttons button {
            background-color: #2563eb; /* Blue button */
            color: #ffffff;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            border: none;
        }
        .action-buttons button:hover {
            background-color: #1d4ed8; /* Darker blue on hover */
            transform: translateY(-1px);
        }
        .action-buttons button:active {
            transform: translateY(0);
        }

        /* Message Display */
        #message {
            background-color: #d1fae5; /* Light green for success */
            color: #065f46; /* Dark green text */
            padding: 0.75rem 1rem;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            margin-top: 0.5rem;
            position: absolute; /* Position relative to container */
            top: 50%; /* Center vertically */
            left: 50%; /* Center horizontally */
            transform: translate(-50%, -50%); /* Adjust for perfect centering */
            min-width: 300px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            visibility: hidden; /* Hidden by default */
            opacity: 0;
            transition: visibility 0s, opacity 0.5s ease-out, background-color 0.3s ease, color 0.3s ease;
            z-index: 100; /* Ensure it's on top */
        }
        #message.show {
            visibility: visible;
            opacity: 1;
        }
        #bookmarkReminder {
            background-color: #fffbeb; /* Light yellow */
            color: #92400e; /* Dark yellow/orange text */
            padding: 0.75rem 1rem;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            margin-bottom: 1rem; /* Space below the reminder */
            opacity: 0; /* Start hidden */
            transition: opacity 1s ease-in-out, background-color 0.3s ease, color 0.3s ease;
        }
        #bookmarkReminder.show {
            opacity: 1;
        }

        /* Description Section Styling */
        .brief-description,
        .description-section p,
        .description-section ul li {
            color: #4a5568; /* gray-600 */
        }
        .description-section h2,
        .description-section h3 {
            color: #4a5568; /* gray-700 */
        }
        .description-section {
            padding: 1rem;
            background-color: #f8fafc; /* Very light gray */
            border-radius: 8px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0; /* Light border */
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .description-section h2 {
            font-size: 1.25rem; /* text-xl */
            font-weight: 600; /* font-semibold */
            margin-bottom: 0.75rem; /* mb-3 */
        }
        .description-section h3 {
            font-size: 1.125rem; /* text-lg */
            font-weight: 600; /* font-semibold */
            margin-bottom: 0.5rem; /* mb-2 */
        }
        .description-section p {
            line-height: 1.6; /* leading-relaxed */
            margin-bottom: 1rem; /* mb-4 */
        }
        .description-section ul {
            list-style: disc;
            list-style-position: inside;
            padding-left: 1rem;
            margin-bottom: 1rem; /* Adjust if needed */
        }
        .description-section ul li {
            margin-bottom: 0.5rem; /* space-y-2 */
            line-height: 1.5;
        }
        .description-section strong {
            font-weight: 700; /* font-bold */
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: #1a202c; /* Darker background for body */
        }
        body.dark-mode .container {
            background-color: #2d3748; /* Darker background for container */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.15);
        }
        body.dark-mode h1,
        body.dark-mode .brief-description,
        body.dark-mode .description-section p,
        body.dark-mode .description-section ul li,
        body.dark-mode .description-section h2,
        body.dark-mode .description-section h3 {
            color: #e2e8f0; /* Light text for dark mode */
        }
        body.dark-mode .editable-area {
            background-color: #111827; /* Very dark background for editable area */
            color: #f8fafc; /* Light text color */
            border-color: #4a5568; /* Darker border */
        }
        body.dark-mode .editable-area:focus {
            border-color: #6366f1; /* Purple border on focus */
        }
        body.dark-mode .toolbar {
            background-color: #4a5568; /* Darker toolbar background */
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.4);
        }
        body.dark-mode .toolbar-button,
        body.dark-mode .toolbar-select,
        body.dark-mode .toolbar-color-picker,
        body.dark-mode .action-button {
            background-color: #6b7280; /* Darker button background */
            color: #f8fafc; /* Light text */
            border-color: #718096; /* Darker border */
        }
        body.dark-mode .toolbar-button:hover,
        body.dark-mode .toolbar-select:hover,
        body.dark-mode .action-button:hover {
            background-color: #718096; /* Slightly lighter dark on hover */
            border-color: #a0aec0;
        }
        body.dark-mode .toolbar-button.active {
            background-color: #4f46e5; /* Dark purple active */
            color: #ffffff;
            border-color: #4f46e5;
        }
        body.dark-mode .action-buttons button {
            background-color: #4f46e5; /* Darker blue button */
            color: #ffffff;
        }
        body.dark-mode .action-buttons button:hover {
            background-color: #6366f1; /* Even darker blue on hover */
        }
        body.dark-mode #message {
            background-color: #166534; /* Darker green for success */
            color: #d1fae5; /* Lighter green text */
        }
        body.dark-mode #bookmarkReminder {
            background-color: #58330a; /* Darker yellow for reminder */
            color: #fbd38d; /* Lighter yellow text */
        }
        body.dark-mode #loadingMessage {
            background-color: #1e3a8a; /* Darker blue for loading */
            color: #bfdbfe; /* Lighter blue text */
        }
        body.dark-mode .description-section {
            background-color: #2d3748; /* Darker background for description section */
            border-color: #4a5568; /* Darker border */
        }
        body.dark-mode .filename-input-group label {
            color: #e2e8f0; /* Light text for label in dark mode */
        }
        body.dark-mode .filename-input-group input {
            background-color: #1a202c; /* Dark input background */
            border-color: #4a5568; /* Dark input border */
            color: #f8fafc; /* Light input text */
        }

        /* Dark Mode Toggle Switch Styling */
        .theme-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
            vertical-align: middle;
            margin-left: 10px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #6366f1; /* Purple for dark mode */
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #6366f1;
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Basic print styles */
        @media print {
            body {
                background-color: #ffffff;
                margin: 0;
                padding: 0;
            }
            .container {
                box-shadow: none;
                border: none;
                padding: 0;
                width: auto;
                max-width: none;
            }
            .action-button, h1, .toolbar, .action-buttons, #message, #bookmarkReminder, .description-section, .brief-description, .theme-switch-container, .filename-input-group { /* Hide filename input group too */
                display: none; /* Hide all interactive elements, reminders, and description when printing */
            }
            .editable-area {
                border: none;
                min-height: auto;
                font-size: 12pt;
                line-height: 1.5;
                padding: 0;
                width: 100%;
                box-sizing: border-box;
                padding: 0.5in; /* Add some margins for print */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="flex justify-between items-center mb-4">
            <h1 class="text-2xl font-bold text-gray-800 text-center flex-grow">Paste and Print</h1>
            <div class="theme-switch-container flex items-center">
                <span class="text-gray-700 dark:text-gray-300 mr-2">Light</span>
                <label class="theme-switch">
                    <input type="checkbox" id="darkModeToggle">
                    <span class="slider round"></span>
                </label>
                <span class="text-gray-700 dark:text-gray-300 ml-2">Dark</span>
            </div>
        </div>

        <!-- Bookmark Reminder Message -->
        <div id="bookmarkReminder" class="show">
            Tip: Bookmark this page (Ctrl+D or Cmd+D) to easily return later!
        </div>

        <!-- Brief Description at the top -->
        <p class="brief-description text-center mb-4 leading-relaxed">
            <strong>Paste and Print</strong> is a free, intuitive, and web-based word processor designed for anyone who needs to quickly paste text, apply basic formatting, and prepare documents for printing or download without any software installation.
        </p>

        <!-- Editing Toolbar -->
        <div class="toolbar">
            <button class="toolbar-button" data-command="bold" title="Bold"><b>B</b></button>
            <button class="toolbar-button" data-command="italic" title="Italic"><i>I</i></button>
            <button class="toolbar-button" data-command="underline" title="Underline"><u>U</u></button>

            <select class="toolbar-select" id="fontFamilySelect" title="Font Family">
                <option value="Inter, sans-serif">Inter</option>
                <option value="Arial, sans-serif">Arial</option>
                <option value="Verdana, sans-serif">Verdana</option>
                <option value="Georgia, serif">Georgia</option>
                <option value="Times New Roman, serif">Times New Roman</option>
                <option value="Courier New, monospace">Courier New</option>
            </select>

            <select class="toolbar-select" id="fontSizeSelect" title="Font Size">
                <option value="1">Smallest</option>
                <option value="2">Smaller</option>
                <option value="3" selected>Small</option> <!-- Default -->
                <option value="4">Medium</option>
                <option value="5">Large</option>
                <option value="6">Larger</option>
                <option value="7">Largest</option>
            </select>

            <input type="color" id="textColorPicker" class="toolbar-color-picker" title="Text Color" value="#000000">
            <input type="color" id="highlightColorPicker" class="toolbar-color-picker" title="Highlight Color" value="#ffffff">
        </div>

        <!-- Content Editable Area -->
        <div id="textInput" contenteditable="true" class="editable-area" role="textbox" aria-multiline="true">
            <p>Type or paste your text here. Select text to apply formatting!</p>
        </div>

        <!-- Message display area -->
        <div id="loadingMessage" style="display:none; text-align:center; padding:10px; background-color:#e0f2fe; color:#0b72c4; border-radius:8px; margin-top:10px;">Generating PDF... Please wait.</div>
        <div id="message"></div>

        <!-- Filename Input -->
        <div class="filename-input-group flex items-center justify-end mb-4">
            <label for="filenameInput" class="text-gray-700 mr-2">Filename:</label>
            <input type="text" id="filenameInput" placeholder="document" class="p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 flex-grow max-w-xs">
        </div>

        <!-- Action Buttons (Print, Download PDF, Download DOC, Download TXT) -->
        <div class="action-buttons">
            <button id="downloadPdfButton" class="action-button">Download as PDF</button>
            <button id="downloadDocButton" class="action-button">Download as HTML (for Word)</button>
            <button id="downloadTxtButton" class="action-button">Download as TXT</button>
            <button id="printButton" class="action-button">Print Document</button>
        </div>

        <!-- Detailed Description Section at the bottom -->
        <div class="description-section">
            <h2 class="text-xl font-semibold mb-2">About Paste and Print: Features &amp; Benefits</h2>
            <p class="mb-4 leading-relaxed">
                Say goodbye to complex interfaces and unnecessary features; our tool focuses on delivering a streamlined experience for your everyday text handling needs.
            </p>

            <h3 class="text-lg font-semibold mb-2">Key Features &amp; Benefits:</h3>
            <ul class="list-disc list-inside space-y-2">
                <li><strong>Effortless Text Pasting:</strong> Instantly paste any text content from your clipboard into a clean, editable canvas. Ideal for snippets, articles, emails, or notes.</li>
                <li><strong>Intuitive Text Formatting:</strong> Easily bold, italicize, underline, change font family, adjust font size, and modify text or highlight colors. Perfect for making your content visually organized and readable.</li>
                <li><strong>Seamless Document Printing:</strong> Prepare your text for a professional printout with a dedicated print button that optimizes your content for physical copies.</li>
                <li><strong>Versatile Download Options:</strong> Save your edited work as a PDF for universal compatibility or as an HTML file (easily opened in Microsoft Word or other rich text editors) for further editing.</li>
                <li><strong>Web-Based Convenience:</strong> Access and use Paste and Print directly from any web browser on any device (desktop, tablet, mobile) â€“ no downloads, no installations, completely free.</li>
                <li><strong>Clean &amp; User-Friendly Interface:</strong> Enjoy a distraction-free environment that prioritizes ease of use, making text manipulation simple for everyone.</li>
            </ul>

            <p class="mt-4 leading-relaxed">
                Whether you're a student preparing notes, a professional drafting quick emails, or anyone needing to clean up text before sharing or printing, <strong>Paste and Print</strong> offers a fast, reliable, and accessible solution. Bookmark this page (Ctrl+D or Cmd+D) for instant access whenever you need a quick text tool.
            </p>
        </div>
        <!-- End Detailed Description Section -->

    </div>

    <script>
        const textInput = document.getElementById('textInput');
        const printButton = document.getElementById('printButton');
        const fontFamilySelect = document.getElementById('fontFamilySelect');
        const fontSizeSelect = document.getElementById('fontSizeSelect');
        const textColorPicker = document.getElementById('textColorPicker');
        const highlightColorPicker = document.getElementById('highlightColorPicker');
        const downloadPdfButton = document.getElementById('downloadPdfButton');
        const downloadDocButton = document.getElementById('downloadDocButton');
        const downloadTxtButton = document.getElementById('downloadTxtButton');
        const filenameInput = document.getElementById('filenameInput'); // New filename input element
        const messageDisplay = document.getElementById('message');
        const loadingMessage = document.getElementById('loadingMessage');
        const bookmarkReminder = document.getElementById('bookmarkReminder');
        const darkModeToggle = document.getElementById('darkModeToggle');

        const LOCAL_STORAGE_DARK_MODE_KEY = 'darkModeEnabled';

        // Function to get the desired filename
        function getFileName(extension) {
            const baseName = filenameInput.value.trim();
            return `${baseName || 'document'}.${extension}`;
        }

        // Function to display temporary messages (e.g., for download success)
        function showMessage(text, isError = false) {
            messageDisplay.textContent = text;
            messageDisplay.className = '';
            messageDisplay.classList.add('show');
            if (isError) {
                messageDisplay.classList.add('bg-red-100', 'text-red-700');
            } else {
                messageDisplay.classList.add('bg-green-100', 'text-green-700');
            }
            messageDisplay.style.top = '50%';
            messageDisplay.style.left = '50%';
            messageDisplay.style.transform = 'translate(-50%, -50%)';
            setTimeout(() => {
                messageDisplay.className = '';
            }, 3000);
        }

        // Apply commands to selected text
        function applyCommand(command, value = null) {
            document.execCommand(command, false, value);
            textInput.focus();
        }

        // Function to set or unset dark mode
        function setDarkMode(isEnabled) {
            if (isEnabled) {
                document.body.classList.add('dark-mode');
            } else {
                document.body.classList.remove('dark-mode');
            }
            localStorage.setItem(LOCAL_STORAGE_DARK_MODE_KEY, isEnabled ? 'enabled' : 'disabled');
        }

        // Event listeners for toolbar buttons
        document.querySelectorAll('.toolbar-button').forEach(button => {
            button.addEventListener('click', () => {
                const command = button.dataset.command;
                applyCommand(command);
            });
        });

        // Event listener for font family select
        fontFamilySelect.addEventListener('change', (event) => {
            applyCommand('fontName', event.target.value);
        });

        // Event listener for font size select
        fontSizeSelect.addEventListener('change', (event) => {
            applyCommand('fontSize', event.target.value);
        });

        // Event listener for text color picker
        textColorPicker.addEventListener('input', (event) => {
            applyCommand('foreColor', event.target.value);
        });

        // Event listener for highlight color picker
        highlightColorPicker.addEventListener('input', (event) => {
            applyCommand('backColor', event.target.value);
        });

        // Print functionality
        printButton.addEventListener('click', function() {
            const textContent = textInput.innerHTML;

            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Print Document</title>
                    <style>
                        body {
                            font-family: 'Inter', sans-serif;
                            margin: 1in;
                            font-size: 12pt;
                            line-height: 1.5;
                        }
                    </style>
                </head>
                <body>
                    ${textContent}
                </body>
                </html>
            `);
            printWindow.document.close();

            printWindow.onload = function() {
                printWindow.print();
            };
        });

        // Download as PDF functionality
        downloadPdfButton.addEventListener('click', async function() {
            loadingMessage.style.display = 'block';
            downloadPdfButton.disabled = true;

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');

            const canvas = await html2canvas(textInput, {
                scale: 1.5,
                useCORS: true,
                logging: false
            });

            const imgData = canvas.toDataURL('image/png');
            const imgWidth = 210;
            const pageHeight = 297;

            const imgHeight = canvas.height * imgWidth / canvas.width;
            let heightLeft = imgHeight;
            let position = 0;

            doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;

            while (heightLeft >= 0) {
                position = heightLeft - imgHeight;
                doc.addPage();
                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
            }

            doc.save(getFileName('pdf')); // Use the new getFileName function

            loadingMessage.style.display = 'none';
            downloadPdfButton.disabled = false;
            showMessage('PDF downloaded successfully!');
        });

        // Download as HTML (for Word) functionality
        downloadDocButton.addEventListener('click', function() {
            const textContent = textInput.innerHTML;
            const blob = new Blob([textContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = getFileName('html'); // Use the new getFileName function
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showMessage('HTML document downloaded successfully!');
        });

        // Download as TXT functionality
        downloadTxtButton.addEventListener('click', function() {
            const textContent = textInput.innerText;
            const blob = new Blob([textContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = getFileName('txt'); // Use the new getFileName function
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showMessage('TXT document downloaded successfully!');
        });

        // Dark Mode Toggle Listener
        darkModeToggle.addEventListener('change', (event) => {
            setDarkMode(event.target.checked);
        });

        // Initialize theme on page load
        window.onload = function() {
            const savedTheme = localStorage.getItem(LOCAL_STORAGE_DARK_MODE_KEY);
            if (savedTheme === 'enabled') {
                darkModeToggle.checked = true;
                setDarkMode(true);
            } else {
                darkModeToggle.checked = false;
                setDarkMode(false);
            }

            bookmarkReminder.classList.add('show');
            setTimeout(() => {
                bookmarkReminder.style.opacity = '0';
                setTimeout(() => {
                    bookmarkReminder.style.display = 'none';
                }, 1000);
            }, 5000);
        };
    </script>
</body>
</html>
